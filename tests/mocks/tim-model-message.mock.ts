import { omit } from 'lodash';
import { DatInsuranceSchema, DocketPrefix, Message, OPERATIONS } from '../../src/kafka/kafka.definition';

export const timModelMessage: Message<DatInsuranceSchema> = {
  model: 'TimModel',
  operationType: 'CREATE' as OPERATIONS,
  state: {
    carrierId: '1000040',
    docketPrefix: 'MC' as DocketPrefix,
    docketNumber: 95516,
    dotNumber: 812313,
    intrastateState: null,
    intrastateCode: null,
    companyName: 'ELITE TRUCKING LLC',
    address: '12240 BELLA TERRA CTR WAY APT 7308',
    city: 'RICHMOND',
    state: 'TX',
    postalCode: '77406',
    phone: '8327710961',
    fax: null,
    certificates: [
      {
        id: 'D110C6D1-E37A-4468-9ED2-9A7CF6C3088A',
        carrierId: '1000040',
        participationCode: 'YES',
        created: '2022-05-18T12:57:47Z',
        insuredName: 'ELITE TRUCKING LLC',
        insuredAddress: '12240BELLATERRACTRWAYAPT7308',
        insuredCity: 'RICHMOND',
        insuredStateCode: 'TX',
        insuredPostalCode: '77406',
        insuredPhone: null,
        insuredFax: null,
        coverages: [
          {
            id: '7CC81CE9-0855-4374-8504-17D9FC9E9F39',
            certificateId: 'D110C6D1-E37A-4468-9ED2-9A7CF6C3088A',
            coverageType: 'PHYSICAL_DAMAGE',
            producerPhone: '6007475156',
            producerFax: null,
            effectiveDate: '2021-06-02T00:00:00Z',
            expirationDate: '2022-06-02T00:00:00Z',
            cancelDate: null,
            policyNumber: 'MCP71753A',
            producer: 'GOODMAN-BAKER INSURANCE AGENCY LLC',
            underwriter: 'GREAT WEST CASUALTY CO',
            RmisCertId: 3116735,
            RmisCovgId: 5083426,
            confidence: 'High',
            coverageDetail: 'See Description Box',
            isScheduledAuto: false,
            doNotFaxProducer: false,
            limits: [
              {
                id: '2DF51985-B031-4C81-A801-30D00A5A9442',
                coverageId: '7CC81CE9-0855-4374-8504-17D9FC9E9F39',
                isCargo: false,
                limitAmount: 1000,
                limitDescription: 'Comp. Ded.',
                currencyCode: 'USD',
              },
              {
                id: 'F1AF8882-1111-4A48-B844-6CD41B92FB17',
                coverageId: '7CC81CE9-0855-4374-8504-17D9FC9E9F39',
                isCargo: false,
                limitAmount: 1000,
                limitDescription: 'Coll. Ded.',
                currencyCode: 'USD',
              },
            ],
          },
          {
            id: 'D0872AF9-6A27-4FEE-9D52-3944C263334E',
            certificateId: 'D110C6D1-E37A-4468-9ED2-9A7CF6C3088A',
            coverageType: 'CARGO',
            producerPhone: '6007475156',
            producerFax: null,
            effectiveDate: '2021-06-02T00:00:00Z',
            expirationDate: '2022-06-02T00:00:00Z',
            cancelDate: null,
            policyNumber: 'MCP71753A',
            producer: 'GOODMAN-BAKER INSURANCE AGENCY LLC',
            underwriter: 'GREAT WEST CASUALTY CO',
            RmisCertId: 3116735,
            RmisCovgId: 5083427,
            confidence: 'High',
            coverageDetail: 'Broad Form',
            isScheduledAuto: false,
            doNotFaxProducer: false,
            limits: [
              {
                id: 'E3A1A22A-8849-4B37-BD01-242C1B8222BE',
                coverageId: 'D0872AF9-6A27-4FEE-9D52-3944C263334E',
                isCargo: true,
                limitAmount: 100000,
                limitDescription: 'Limit',
                currencyCode: 'USD',
              },
              {
                id: '92F1DE5B-08C6-42C9-A9EF-59CE858C80AE',
                coverageId: 'D0872AF9-6A27-4FEE-9D52-3944C263334E',
                isCargo: false,
                limitAmount: 1000,
                limitDescription: 'Deductible',
                currencyCode: 'USD',
              },
            ],
          },
          {
            id: 'C70A929B-E2E6-4154-AC23-70BF85CB7860',
            certificateId: 'D110C6D1-E37A-4468-9ED2-9A7CF6C3088A',
            coverageType: 'AUTO',
            producerPhone: '6007475156',
            producerFax: null,
            effectiveDate: '2021-06-02T00:00:00Z',
            expirationDate: '2022-06-02T00:00:00Z',
            cancelDate: null,
            policyNumber: 'MCP71753A',
            producer: 'GOODMAN-BAKER INSURANCE AGENCY LLC',
            underwriter: 'GREAT WEST CASUALTY CO',
            RmisCertId: 3116735,
            RmisCovgId: 5083425,
            confidence: 'High',
            coverageDetail: 'Scheduled Autos|Hired Autos|See Description Box|Non-owned Autos',
            isScheduledAuto: true,
            doNotFaxProducer: false,
            limits: [
              {
                id: '5831B66F-14F8-4B68-A0FD-5EF385005672',
                coverageId: 'C70A929B-E2E6-4154-AC23-70BF85CB7860',
                isCargo: false,
                limitAmount: 1000000,
                limitDescription: 'Combined Single Limit (Each Accident)',
                currencyCode: 'USD',
              },
            ],
          },
          {
            id: '74F6C084-E06C-4695-A03E-BEC944EC117A',
            certificateId: 'D110C6D1-E37A-4468-9ED2-9A7CF6C3088A',
            coverageType: 'GENERAL',
            producerPhone: '6007475156',
            producerFax: null,
            effectiveDate: '2021-06-02T00:00:00Z',
            expirationDate: '2022-06-02T00:00:00Z',
            cancelDate: null,
            policyNumber: 'MCP71753A',
            producer: 'GOODMAN-BAKER INSURANCE AGENCY LLC',
            underwriter: 'GREAT WEST CASUALTY CO',
            RmisCertId: 3116735,
            RmisCovgId: 5083428,
            confidence: 'High',
            coverageDetail: 'General Aggregate Limit Applies Per Policy|Occur',
            isScheduledAuto: false,
            doNotFaxProducer: false,
            limits: [
              {
                id: 'C11EF383-AA5E-4F2B-A988-1BF0CBC0015C',
                coverageId: '74F6C084-E06C-4695-A03E-BEC944EC117A',
                isCargo: false,
                limitAmount: 1000000,
                limitDescription: 'Personal & Adv Injury',
                currencyCode: 'USD',
              },
              {
                id: '943518F8-0459-4608-A64A-3C47662192B2',
                coverageId: '74F6C084-E06C-4695-A03E-BEC944EC117A',
                isCargo: false,
                limitAmount: 5000,
                limitDescription: 'Medical Expense (Any One Person)',
                currencyCode: 'USD',
              },
              {
                id: '3183428C-5554-4E49-B7F5-7C800C62C218',
                coverageId: '74F6C084-E06C-4695-A03E-BEC944EC117A',
                isCargo: false,
                limitAmount: 100000,
                limitDescription: 'Damage To Rented Premises (Each Occurrence)',
                currencyCode: 'USD',
              },
              {
                id: '0FCEED94-E155-40B3-A4D8-83794F09C9DA',
                coverageId: '74F6C084-E06C-4695-A03E-BEC944EC117A',
                isCargo: false,
                limitAmount: 2000000,
                limitDescription: 'Products - Comp/Op Agg',
                currencyCode: 'USD',
              },
              {
                id: '8A97D71C-8C42-4F22-ABF8-A2D24504B3BE',
                coverageId: '74F6C084-E06C-4695-A03E-BEC944EC117A',
                isCargo: false,
                limitAmount: 1000000,
                limitDescription: 'Each Occurrence',
                currencyCode: 'USD',
              },
              {
                id: 'D066EF63-A524-4C7B-86C3-E24205925D64',
                coverageId: '74F6C084-E06C-4695-A03E-BEC944EC117A',
                isCargo: false,
                limitAmount: 2000000,
                limitDescription: 'General Aggregate',
                currencyCode: 'USD',
              },
            ],
          },
        ],
      },
    ],
  },
};

export const timModelDBReturnData: any = {
  businessUnitId: '1000040',
  certificates: [
    {
      id: 'D110C6D1-E37A-4468-9ED2-9A7CF6C3088A',
      participationCode: 'YES',
      created: '2022-05-18T12:57:47Z',
      insuredName: 'ELITE TRUCKING LLC',
      insuredAddress: '12240BELLATERRACTRWAYAPT7308',
      insuredCity: 'RICHMOND',
      insuredStateCode: 'TX',
      insuredPostalCode: '77406',
      insuredPhone: null,
      insuredFax: null,
      coverages: [
        {
          id: '74F6C084-E06C-4695-A03E-BEC944EC117A',
          coverageType: 'GENERAL',
          producerPhone: '6007475156',
          producerFax: null,
          expirationDate: '2022-06-02 00:00:00',
          effectiveDate: '2021-06-02 00:00:00',
          cancelDate: null,
          policyNumber: 'MCP71753A',
          producer: 'GOODMAN-BAKER INSURANCE AGENCY LLC',
          underwriter: 'GREAT WEST CASUALTY CO',
          rmisCertId: 3116735,
          rmisCovgId: 5083428,
          confidence: 'High',
          coverageDetail: 'General Aggregate Limit Applies Per Policy|Occur',
          isScheduledAuto: false,
          doNotFaxProducer: false,
          limits: [
            {
              id: '0FCEED94-E155-40B3-A4D8-83794F09C9DA',
              isCargo: false,
              limitAmount: 2000000,
              limitDescription: 'Products - Comp/Op Agg',
              currencyCode: 'USD',
            },
            {
              id: '3183428C-5554-4E49-B7F5-7C800C62C218',
              isCargo: false,
              limitAmount: 100000,
              limitDescription: 'Damage To Rented Premises (Each Occurrence)',
              currencyCode: 'USD',
            },
            {
              id: '8A97D71C-8C42-4F22-ABF8-A2D24504B3BE',
              isCargo: false,
              limitAmount: 1000000,
              limitDescription: 'Each Occurrence',
              currencyCode: 'USD',
            },
            {
              id: '943518F8-0459-4608-A64A-3C47662192B2',
              isCargo: false,
              limitAmount: 5000,
              limitDescription: 'Medical Expense (Any One Person)',
              currencyCode: 'USD',
            },
            {
              id: 'C11EF383-AA5E-4F2B-A988-1BF0CBC0015C',
              isCargo: false,
              limitAmount: 1000000,
              limitDescription: 'Personal & Adv Injury',
              currencyCode: 'USD',
            },
            {
              id: 'D066EF63-A524-4C7B-86C3-E24205925D64',
              isCargo: false,
              limitAmount: 2000000,
              limitDescription: 'General Aggregate',
              currencyCode: 'USD',
            },
          ],
        },
        {
          id: '7CC81CE9-0855-4374-8504-17D9FC9E9F39',
          coverageType: 'PHYSICAL_DAMAGE',
          producerPhone: '6007475156',
          producerFax: null,
          expirationDate: '2022-06-02 00:00:00',
          effectiveDate: '2021-06-02 00:00:00',
          cancelDate: null,
          policyNumber: 'MCP71753A',
          producer: 'GOODMAN-BAKER INSURANCE AGENCY LLC',
          underwriter: 'GREAT WEST CASUALTY CO',
          rmisCertId: 3116735,
          rmisCovgId: 5083426,
          confidence: 'High',
          coverageDetail: 'See Description Box',
          isScheduledAuto: false,
          doNotFaxProducer: false,
          limits: [
            {
              id: '2DF51985-B031-4C81-A801-30D00A5A9442',
              isCargo: false,
              limitAmount: 1000,
              limitDescription: 'Comp. Ded.',
              currencyCode: 'USD',
            },
            {
              id: 'F1AF8882-1111-4A48-B844-6CD41B92FB17',
              isCargo: false,
              limitAmount: 1000,
              limitDescription: 'Coll. Ded.',
              currencyCode: 'USD',
            },
          ],
        },
        {
          id: 'C70A929B-E2E6-4154-AC23-70BF85CB7860',
          coverageType: 'AUTO',
          producerPhone: '6007475156',
          producerFax: null,
          expirationDate: '2022-06-02 00:00:00',
          effectiveDate: '2021-06-02 00:00:00',
          cancelDate: null,
          policyNumber: 'MCP71753A',
          producer: 'GOODMAN-BAKER INSURANCE AGENCY LLC',
          underwriter: 'GREAT WEST CASUALTY CO',
          rmisCertId: 3116735,
          rmisCovgId: 5083425,
          confidence: 'High',
          coverageDetail: 'Scheduled Autos|Hired Autos|See Description Box|Non-owned Autos',
          isScheduledAuto: true,
          doNotFaxProducer: false,
          limits: [
            {
              id: '5831B66F-14F8-4B68-A0FD-5EF385005672',
              isCargo: false,
              limitAmount: 1000000,
              limitDescription: 'Combined Single Limit (Each Accident)',
              currencyCode: 'USD',
            },
          ],
        },
        {
          id: 'D0872AF9-6A27-4FEE-9D52-3944C263334E',
          coverageType: 'CARGO',
          producerPhone: '6007475156',
          producerFax: null,
          expirationDate: '2022-06-02 00:00:00',
          effectiveDate: '2021-06-02 00:00:00',
          cancelDate: null,
          policyNumber: 'MCP71753A',
          producer: 'GOODMAN-BAKER INSURANCE AGENCY LLC',
          underwriter: 'GREAT WEST CASUALTY CO',
          rmisCertId: 3116735,
          rmisCovgId: 5083427,
          confidence: 'High',
          coverageDetail: 'Broad Form',
          isScheduledAuto: false,
          doNotFaxProducer: false,
          limits: [
            {
              id: '92F1DE5B-08C6-42C9-A9EF-59CE858C80AE',
              isCargo: false,
              limitAmount: 1000,
              limitDescription: 'Deductible',
              currencyCode: 'USD',
            },
            {
              id: 'E3A1A22A-8849-4B37-BD01-242C1B8222BE',
              isCargo: true,
              limitAmount: 100000,
              limitDescription: 'Limit',
              currencyCode: 'USD',
            },
          ],
        },
      ],
    },
  ],
};

export function removeTimModelDBAutogeneratedEntities(timDBModel: any): any {
  // TODO: Fix this Partial<DatInsuranceEntity> {
  const omittedDates = ['createdDate', 'updatedDate'];
  const certificate: any = omit(timDBModel.certificates[0], omittedDates);

  const coveragesMap: any = (coverages: any) =>
    coverages.map((coverage: any) => {
      return omit({ ...coverage, limits: limitsMap(coverage.limits) }, omittedDates);
    });

  const limitsMap: any = (limits: any) => limits.map((limit: any) => omit(limit, omittedDates));

  return {
    businessUnitId: timModelMessage.state.carrierId,
    certificates: [{ ...certificate, coverages: coveragesMap(certificate.coverages) }],
  };
}
